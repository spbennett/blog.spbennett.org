---
title: "Google Cloud - Static Website Hosting"
date: 2018-06-19T15:52:49-07:00
draft: false
---

1. [Overview](#overview)
1. [Setup](#setup)
 1. [Hugo](#hugo)
 1. [Google Domains](#googledomains)
 1. [Google Cloud Storage](#googlecloudstorage)
1. [Maintenance](#maintenance)
1. [Coming Soon](#comingsoon)

## Overview {#overview}
This post describes how you can use [Google Cloud Platform](https://cloud.google.com) to host a static website generated by [Hugo](https://gohugo.io/getting-started/quick-start/) just like this one! The following tools are required:

* [Google Domains](domains.google/)
* [Google Cloud Storage](https://cloud.google.com/storage/)
* [Hugo](https://gohugo.io)

## Setup {#setup}

### Hugo {#hugo}

[Hugo](https://gohugo.io/getting-started/quick-start/) is a Go based static website generator.  I chose it for the breadth of themes support.  You should be able to find Hugo with your favorite package manager.   If you're on OSX 10.12 like me, use [homebrew](https://brew.sh).

```shell
brew install hugo
```

Once Hugo is installed, generate a barebones static site for testing by running the following:

```shell
hugo new site quickstart
cd quickstart
hugo
``` 

This will put the static content into a directory called *public*.  Later we'll copy this content to your Google Cloud Storage bucket with **gsutil**.

### Google Domains {#googledomains}

You'll need a domain name.  You can start by visiting [Google Domains](https://domains.google/) and registering your own.  Depending on the name, you can get your own personal domain for as low as $12/year.

Once you've decided on a name, you'll want to register a CNAME which is what we'll use for the endpoint of our Hugo based blog.  Let's assume your domain is www.example.com, and your blog is blog.example.com.

Edit your domain and choose **Configure DNS**.

1. Scroll to **Custom resource records**.
2. From the Drop Down, choose **CNAME**.
3. Enter your domain information in the format below:

```text
NAME    TYPE    TTL     DATA
blog    CNAME   1h      c.storage.googleapis.com
```

Once this is complete, you will be able to have DNS point to your Google Cloud Storage bucket that matches the **blog.example.com** convention.

### Google Cloud Storage {#googlecloudstorage}

You'll need a place to store your website assets.  You can create a new bucket in Google Cloud Storage that follows the naming convention established by your CNAME and Domain combination.

```shell
gsutil -m mb gs://blog.example.com
```

Use a multiregion bucket to serve your content.  Once the bucket is generated, you can put your data in with the commands below:


```shell
gsutil -m cp -r public/* gs://blog.example.com
```

Next, change permissions to make all the uploaded content viewable:

```shell
gsutil -m acl ch -r -u AllUsers:R gs://blog.example.com
```

Then finally instruct Google Cloud to serve your content by setting *index.html* as your homepage:

```shell
gsutil web set -m index.html -e 404 gs://blog.example.com
```

## Maintenance {#maintenance}

Once the steps above are complete, you should have your blog fully up and running.  To add new posts, just generate new markdown files in Hugo with the following command:

```shell
hugo new post/002-post.md
```

add some content to the post then clear the old data in *public/* away and regenerate the website:

```shell
rm -rf public/
hugo
```

Take your new website and sync your Google Cloud Storage bucket with **gsutil**:

```shell
cd public/
gsutil -m rsync -R . gs://blog.example.com
```

Now you've got a blog you can update!

## Coming Soon {#comingsoon}

Wouldn't it be nice if we could just update our website with:

```shell
git push
```

... there is a way.